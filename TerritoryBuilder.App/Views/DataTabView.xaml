<UserControl x:Class="TerritoryBuilder.App.Views.DataTabView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
    <UserControl.Resources>
        <BooleanToVisibilityConverter x:Key="BoolToVisibilityConverter" />
    </UserControl.Resources>
    <ScrollViewer VerticalScrollBarVisibility="Auto">
        <StackPanel Margin="12">
            <TextBlock Text="Data Intake"
                       FontSize="22"
                       FontWeight="Bold"
                       Foreground="{StaticResource TextPrimaryBrush}"
                       Margin="0,0,0,4" />
            <TextBlock Text="Load source files and execute the full assignment workflow from one place."
                       Margin="0,0,0,12" />

            <GroupBox Header="Source files">
                <StackPanel>
                    <TextBlock Text="LightBox CSV" Foreground="{StaticResource TextPrimaryBrush}" FontWeight="SemiBold"/>
                    <DockPanel>
                        <Button Content="Browse" Command="{Binding BrowseLightBoxFileCommand}" Width="96" DockPanel.Dock="Right" Margin="8,0,0,0" Style="{StaticResource SecondaryButtonStyle}"/>
                        <TextBox Text="{Binding LightBoxPath, UpdateSourceTrigger=PropertyChanged}"/>
                    </DockPanel>

                    <TextBlock Text="Zones GeoJSON" Margin="0,10,0,0" Foreground="{StaticResource TextPrimaryBrush}" FontWeight="SemiBold"/>
                    <DockPanel>
                        <Button Content="Browse" Command="{Binding BrowseZoneGeoJsonFileCommand}" Width="96" DockPanel.Dock="Right" Margin="8,0,0,0" Style="{StaticResource SecondaryButtonStyle}"/>
                        <TextBox Text="{Binding ZoneGeoJsonPath, UpdateSourceTrigger=PropertyChanged}"/>
                    </DockPanel>

                    <TextBlock Text="Rep roster CSV" Margin="0,10,0,0" Foreground="{StaticResource TextPrimaryBrush}" FontWeight="SemiBold"/>
                    <DockPanel>
                        <Button Content="Browse" Command="{Binding BrowseRepRosterFileCommand}" Width="96" DockPanel.Dock="Right" Margin="8,0,0,0" Style="{StaticResource SecondaryButtonStyle}"/>
                        <TextBox Text="{Binding RepRosterPath, UpdateSourceTrigger=PropertyChanged}"/>
                    </DockPanel>

                    <TextBlock Text="Exclusion CSV (optional)" Margin="0,10,0,0" Foreground="{StaticResource TextPrimaryBrush}" FontWeight="SemiBold"/>
                    <DockPanel>
                        <Button Content="Browse" Command="{Binding BrowseExclusionFileCommand}" Width="96" DockPanel.Dock="Right" Margin="8,0,0,0" Style="{StaticResource SecondaryButtonStyle}"/>
                        <TextBox Text="{Binding ExclusionPath, UpdateSourceTrigger=PropertyChanged}"/>
                    </DockPanel>
                </StackPanel>
            </GroupBox>

            <GroupBox Header="Rep configuration">
                <StackPanel>
                    <TextBlock Text="Or input number of reps" Foreground="{StaticResource TextPrimaryBrush}" FontWeight="SemiBold" />
                    <TextBox Text="{Binding RepCountInput, UpdateSourceTrigger=PropertyChanged}" Width="220"/>
                    <TextBlock Text="{Binding RepRosterCount, StringFormat=Rep count loaded: {0}}" Margin="0,6,0,0" />
                    <CheckBox Content="Show advanced workflow tabs (Filters, Weighted Assignments, Export)" IsChecked="{Binding IsAdvancedMode}" Margin="0,10,0,0"/>
                </StackPanel>
            </GroupBox>

            <StackPanel Orientation="Horizontal" Margin="0,2,0,0">
                <Button Content="Load Data" Command="{Binding LoadDataCommand}" Width="140" Style="{StaticResource SecondaryButtonStyle}"/>
                <Button Content="Run Full Assignment" Command="{Binding RunFullWorkflowCommand}" Width="190" Style="{StaticResource SuccessButtonStyle}"/>
            </StackPanel>

            <ProgressBar IsIndeterminate="True" Visibility="{Binding IsBusy, Converter={StaticResource BoolToVisibilityConverter}}"/>
            <TextBlock Text="Running full workflow..." Margin="0,4,0,0" Visibility="{Binding IsBusy, Converter={StaticResource BoolToVisibilityConverter}}"/>

            <Border BorderBrush="{StaticResource BorderBrush}" BorderThickness="1" Background="White" CornerRadius="10" Padding="12" Margin="0,10,0,0">
                <StackPanel>
                    <TextBlock Text="Status" Foreground="{StaticResource TextPrimaryBrush}" FontWeight="SemiBold" Margin="0" />
                    <TextBlock Text="{Binding StatusMessage}" Margin="0,6,0,0" TextWrapping="Wrap"/>
                </StackPanel>
            </Border>

            <Border BorderBrush="{StaticResource BorderBrush}" BorderThickness="1" Background="#0B1B47" CornerRadius="10" Padding="12" Margin="0,10,0,0">
                <StackPanel>
                    <TextBlock Text="Diagnostics" Foreground="#BFDBFE" FontWeight="SemiBold" Margin="0" />
                    <TextBlock Text="{Binding DiagnosticsMessage}" TextWrapping="Wrap" FontFamily="Consolas" Foreground="#E2E8F0" Margin="0,6,0,0"/>
                </StackPanel>
            </Border>
        </StackPanel>
    </ScrollViewer>
</UserControl>
